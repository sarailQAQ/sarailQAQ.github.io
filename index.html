<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Fast Fishing Transform">
<meta property="og:type" content="website">
<meta property="og:title" content="Sarail wanna sleep all day">
<meta property="og:url" content="http://example.com/">
<meta property="og:site_name" content="Sarail wanna sleep all day">
<meta property="og:description" content="Fast Fishing Transform">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Sarail">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Sarail wanna sleep all day</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/rss2.xml" title="Sarail wanna sleep all day" type="application/rss+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Sarail wanna sleep all day</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-resources">

    <a href="/resources/" rel="section"><i class="download fa-fw"></i>资源</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>站点地图</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/12/18/cf-edu-round100-Find-The-Array/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Sarail">
      <meta itemprop="description" content="Fast Fishing Transform">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sarail wanna sleep all day">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/12/18/cf-edu-round100-Find-The-Array/" class="post-title-link" itemprop="url">cf edu(round100)-Find The Array</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-12-18 00:56:44 / 修改时间：01:25:36" itemprop="dateCreated datePublished" datetime="2020-12-18T00:56:44+08:00">2020-12-18</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>链接：<a target="_blank" rel="noopener" href="https://codeforces.ml/contest/1463/problem/B">https://codeforces.ml/contest/1463/problem/B</a></p>
<h2 id="题目大意"><a href="#题目大意" class="headerlink" title="题目大意"></a>题目大意</h2><p>给你一个序列a[1..n]，其中$1\leq a_i \leq 10^9$，S为a所有元素的和。要求构造一个”美丽序列“B[1..n]满足：</p>
<ul>
<li>$1≤b_i≤10^9 $</li>
<li>要么$b_i$ 整除$b_{i+1}$ ，要么$b_{i + 1}$ 整除$b_i$ 。</li>
<li>$2\sum_{i=1}^{n}{|a_i-b_i|}\leq S$</li>
</ul>
<p>保证一定有解，输出任意一种。</p>
<h2 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h2><p>很有意思但是不难的构造题。</p>
<p>因为是第三个条件的左边有个系数2，不难想到利用2进制进行构造。具体做法为，对于任意$a_i$，其对应的$b_i$就是$2^{\lfloor \log_{2}{a_i}\rfloor}$，也就是$a_i$的二进制最高位。</p>
<p>这时我们不难发现，$|a_i-b_i|\leq \frac{a_i}2$，所以一定是满足条件3的。同时，因为B[1..n]都是2的幂，因此任意B的任意两个元素必然有一个可以整除对方。于是这道题就这么做完了<del>（又水了一骗博客）</del>。</p>
<h2 id="AC代码"><a href="#AC代码" class="headerlink" title="AC代码"></a>AC代码</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">50</span> + <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> a[N], n;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getB</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">31</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((<span class="number">1</span> &lt;&lt; i) &gt; x) <span class="keyword">return</span> <span class="number">1</span> &lt;&lt; (i - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T; <span class="built_in">cin</span> &gt;&gt; T;</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a + i);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, getB(a[i]));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/12/18/2020ICPC%EF%BC%88%E4%B8%8A%E6%B5%B7%EF%BC%89-Mine-Sweeper-II/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Sarail">
      <meta itemprop="description" content="Fast Fishing Transform">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sarail wanna sleep all day">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/12/18/2020ICPC%EF%BC%88%E4%B8%8A%E6%B5%B7%EF%BC%89-Mine-Sweeper-II/" class="post-title-link" itemprop="url">2020ICPC（上海）-Mine Sweeper II</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-12-18 00:55:28 / 修改时间：01:28:21" itemprop="dateCreated datePublished" datetime="2020-12-18T00:55:28+08:00">2020-12-18</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>链接：<a target="_blank" rel="noopener" href="https://ac.nowcoder.com/acm/contest/9925/B">https://ac.nowcoder.com/acm/contest/9925/B</a></p>
<h2 id="题目大意"><a href="#题目大意" class="headerlink" title="题目大意"></a>题目大意</h2><p>给你2个n×m扫雷图A、B，图中没有雷的格子会有一个数字x，表示这个格子周围9×9的格子中有多少个雷。现在你可以最多修改B图$\frac {nm}2$次来使得两个图中的数字之和相等，输出修改后的B图。</p>
<h2 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h2><p>考虑数字和就等于相邻（雷格子，非雷格子）二元组的个数，于是把整个地图全反过来这个二元组个数不变，然后 $B$ 与 $A$之间以及 $B$ 与 $inv(A)$ ，即把 $A$ 所有格子全部取反的扫雷地图之间总有一个偏差不超过一半的，所以就选其中偏差不超过一半的然后变过去就行。</p>
<h2 id="AC代码"><a href="#AC代码" class="headerlink" title="AC代码"></a>AC代码</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1000</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> ga[N][N], gb[N][N];</span><br><span class="line"><span class="keyword">int</span> n, m, cntOri, cntInv;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; j++)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, gb[i][j] ? <span class="string">&#x27;X&#x27;</span> : <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">char</span> ch;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; j++) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot; %c&quot;</span>, &amp;ch);</span><br><span class="line">            ga[i][j] = ch == <span class="string">&#x27;X&#x27;</span> ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; j++) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot; %c&quot;</span>, &amp;ch);</span><br><span class="line">            gb[i][j] = ch == <span class="string">&#x27;X&#x27;</span> ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; j++) &#123;</span><br><span class="line">            cntOri += ga[i][j] ^ gb[i][j] ^ <span class="number">1</span> ;</span><br><span class="line">            cntInv += ga[i][j] ^ gb[i][j];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> f = cntOri &gt; cntInv ? <span class="number">0</span> : <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; j++) &#123;</span><br><span class="line">            gb[i][j] = ga[i][j] ^ f;</span><br><span class="line">        &#125;</span><br><span class="line">    print();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/12/15/HDU-5475-An-easy-problem/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Sarail">
      <meta itemprop="description" content="Fast Fishing Transform">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sarail wanna sleep all day">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/12/15/HDU-5475-An-easy-problem/" class="post-title-link" itemprop="url">HDU 5475.An easy problem</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-12-15 00:21:41 / 修改时间：01:08:24" itemprop="dateCreated datePublished" datetime="2020-12-15T00:21:41+08:00">2020-12-15</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="题目大意"><a href="#题目大意" class="headerlink" title="题目大意"></a>题目大意</h2><p>一开始给你一个数n=1和一个模数M（不一定为质数），之后会有q（$q&lt;10^5$）次操作，每次操作操作给两个数f，x（$x&lt;10^9$）</p>
<ul>
<li>f=1时，表示给n乘上x</li>
<li>f=2时，表示给n除以第x次操作乘的那个数</li>
</ul>
<p>每次操作后输出n对M取模的值。</p>
<h2 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h2><p>因为M不为质数，所以显然不能用逆元。x也很大，高精很有可能被卡时间复杂度。此时不难想到万能数据结构——分块。</p>
<p>具体做法是，将每次乘的数放到一个块里，然后对于每个块维护乘数模M的结果<strong>ans[i]</strong>。当f=1时，将x插入到相应的块中，同时将<strong>ans[i]</strong>乘上x再取模。当f=2时，将块中的x直接修改为1，并暴力重构块。</p>
<p>每次操作后n的值就是<strong>ans[]</strong>的积。</p>
<p>当然线段树也是可以的。</p>
<h2 id="AC代码"><a href="#AC代码" class="headerlink" title="AC代码"></a>AC代码</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">opt</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> f, x;</span><br><span class="line">&#125;o[N];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> block[<span class="number">1000</span> + <span class="number">5</span>][<span class="number">2000</span> + <span class="number">5</span>], p[<span class="number">1000</span> + <span class="number">5</span>], ans[<span class="number">1000</span> + <span class="number">5</span>];</span><br><span class="line"><span class="keyword">int</span> arr[N];</span><br><span class="line"><span class="keyword">int</span> n, q, m, lenBlock;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">id</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> lower_bound(arr, arr + q, x) - arr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(p, <span class="number">0</span>, <span class="keyword">sizeof</span> p);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) ans[i] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">process</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    ans[x] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; p[x]; i++) ans[x] = ans[x] * <span class="number">1l</span>l * block[x][i] % m;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getAns</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) res = res * <span class="number">1l</span>l * ans[i] % m;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> pos = id(x), i = pos / lenBlock;</span><br><span class="line">    block[i][p[i]++] = x;</span><br><span class="line">    ans[i] = ans[i] * <span class="number">1l</span>l * x % m;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">del</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> pos = id(x), i = pos / lenBlock;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; p[i]; j++) <span class="keyword">if</span> (block[i][j] == x)&#123;</span><br><span class="line">        block[i][j] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    process(i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T; <span class="built_in">cin</span> &gt;&gt; T;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> kase = <span class="number">1</span>; kase &lt;= T; kase++) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; q &gt;&gt; m;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; q; i++) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;o[i].f, &amp;o[i].x);</span><br><span class="line">            arr[i] = o[i].x;</span><br><span class="line">        &#125;</span><br><span class="line">        sort(arr, arr + q);</span><br><span class="line">        lenBlock = <span class="built_in">sqrt</span>(q + <span class="number">0.5</span>);</span><br><span class="line">        n = <span class="built_in">ceil</span>((q + <span class="number">0.0</span>) / lenBlock);</span><br><span class="line">        build();</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Case #%d:\n&quot;</span>, kase);</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; q; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (o[i].f == <span class="number">1</span>) add(o[i].x), res = res * <span class="number">1l</span>l * o[i].x % m;</span><br><span class="line">            <span class="keyword">else</span> del(o[o[i].x - <span class="number">1</span>].x), res = getAns();</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, res);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/12/15/HDU5478-Can-you-find-it/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Sarail">
      <meta itemprop="description" content="Fast Fishing Transform">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sarail wanna sleep all day">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/12/15/HDU5478-Can-you-find-it/" class="post-title-link" itemprop="url">HDU5478-Can you find it</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-12-15 00:16:03 / 修改时间：01:12:41" itemprop="dateCreated datePublished" datetime="2020-12-15T00:16:03+08:00">2020-12-15</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="题目大意"><a href="#题目大意" class="headerlink" title="题目大意"></a>题目大意</h2><p>有一个对于一个有序数对$(a,b)$和$k1,k2,b1$，要求满足等式  <script type="math/tex">a^{k1⋅n+b1}+ b^{k2⋅n−k2+1} \equiv 0 (mod C)(\forall n = 1, 2, 3, ...)</script></p>
<p> 问这样的a,b 有多少对？以字典序输出。</p>
<h2 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h2><p>当n=1时，有</p>
<p>$a^{k1+b1}+b\equiv0(modC)$        ————式1</p>
<p>当n=2时，有</p>
<p>$a^{k1+b1}a^{k1}+bb^{k2}\equiv0(modC)$        ————式2</p>
<p>又因为 $a^{k1+b1}a^{k1}+ba^{k1}\equiv0(modC)$</p>
<p>所以有$a^{k1}\equiv b^{k2}（modC)$</p>
<p>显然，当n等于1，2时都满足等式的话，后面也是一定会满足的（归纳法）。</p>
<p>所以我们只要判断前两种情况就好了。具体来说，枚举a的所有可能值（1~C-1），然后根据式1算出b，再去判断a，b是否满足式2。由于是从小到大枚举a，因此一定是满足字典序的</p>
<h2 id="AC代码"><a href="#AC代码" class="headerlink" title="AC代码"></a>AC代码</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll C, k1, k2, b1;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">qpow</span><span class="params">(ll base, ll p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (p &lt;= <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    ll res = qpow(base, p &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    res = res * <span class="number">1l</span>l * res % C;</span><br><span class="line">    <span class="keyword">if</span> (p &amp; <span class="number">1</span>) res = res * <span class="number">1l</span>l * base % C;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> kase = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">cin</span> &gt;&gt; C &gt;&gt; k1 &gt;&gt; b1 &gt;&gt; k2) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Case #%d:\n&quot;</span>, ++kase);</span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (ll a = <span class="number">1</span>; a &lt; C; a++) &#123;</span><br><span class="line">            ll b = C - qpow(a, k1 + b1);</span><br><span class="line">            <span class="keyword">if</span> ((qpow(a, (k1 &lt;&lt; <span class="number">1</span>) + b1) + qpow(b, k2 + <span class="number">1</span>)) % C == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%lld %lld\n&quot;</span>, a, b);</span><br><span class="line">                ans++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (ans == <span class="number">0</span>) <span class="built_in">printf</span>(<span class="string">&quot;-1\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/12/06/%E8%BF%9B%E7%A8%8B%E5%86%85%E7%BC%93%E5%AD%98bigcache/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Sarail">
      <meta itemprop="description" content="Fast Fishing Transform">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sarail wanna sleep all day">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/12/06/%E8%BF%9B%E7%A8%8B%E5%86%85%E7%BC%93%E5%AD%98bigcache/" class="post-title-link" itemprop="url">进程内缓存bigcache</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-12-06 15:23:47 / 修改时间：15:25:08" itemprop="dateCreated datePublished" datetime="2020-12-06T15:23:47+08:00">2020-12-06</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>github地址：<a target="_blank" rel="noopener" href="https://github.com/allegro/bigcache">https://github.com/allegro/bigcache</a></p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p><del>先扒一波官方文档凑字数</del></p>
<blockquote>
<p>Fast, concurrent, evicting in-memory cache written to keep big number of entries without impact on performance. BigCache keeps entries on heap but omits GC for them. To achieve that, operations on byte slices take place, therefore entries (de)serialization in front of the cache will be needed in most use cases.</p>
<p>机器翻译：快速，并发，驱逐内存中的高速缓存，以保持大量的条目不影响性能.BigCache将条目保存在堆中，但忽略了它们的GC。为此，对字节片进行操作，因此在大多数用例中都需要缓存前面的条目(反序列化)。</p>
</blockquote>
<p>虽然redis具有非常不错的性能（官方数据读的速度是110000次/秒,写的速度是81000次/秒），但是这并不等于我们一个进程在一秒可以对redis做好几万次操作。比如，现在基本都是用TCP协议建立与本地redis的连接，那么每次对redis进行操作都要把数据打包发到运输层，运输层再发到网络层，然后才返回发到本地的redis进程上。虽然使用pipeline可以减少一部分I/O时间消耗，但总归还是有性能瓶颈，很难达到每秒几万的操作效率。</p>
<p>因此，在没有使用分布式服务器的情况下，进程内缓存就显得很好用了。</p>
<p>此外，bigcache还拥有以下非常好用的特性：</p>
<ul>
<li>即使拥有百万记录也非常快（主要用哈希实现）</li>
<li>提供并发访问</li>
<li>在预定的时间后移除记录</li>
</ul>
<h2 id="简单使用"><a href="#简单使用" class="headerlink" title="简单使用"></a>简单使用</h2><p><del>又来扒拉一波官方文档</del></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&quot;github.com/allegro/bigcache&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// 声明一个缓存</span></span><br><span class="line">    cache, _ := bigcache.NewBigCache(bigcache.DefaultConfig(<span class="number">10</span> * time.Minute))</span><br><span class="line"></span><br><span class="line">    cache.Set(<span class="string">&quot;my-unique-key&quot;</span>, []<span class="keyword">byte</span>(<span class="string">&quot;value&quot;</span>))</span><br><span class="line"></span><br><span class="line">    entry, _ := cache.Get(<span class="string">&quot;my-unique-key&quot;</span>)</span><br><span class="line">    fmt.Println(<span class="keyword">string</span>(entry))   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用该库主要有以下几个特点</p>
<ul>
<li>主要操作只有Set、Get、Delete、Len</li>
<li>只能存取[]byte类型</li>
<li>config对象的设置对速度的影响较大</li>
<li>需要用自定义的config时需要实现Hasher接口</li>
</ul>
<h2 id="config对象简介"><a href="#config对象简介" class="headerlink" title="config对象简介"></a>config对象简介</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Config for BigCache</span></span><br><span class="line"><span class="keyword">type</span> Config <span class="keyword">struct</span> &#123;</span><br><span class="line">	<span class="comment">// Number of cache shards, value must be a power of two</span></span><br><span class="line">    <span class="comment">// 分片类型的数量，用于并发优化</span></span><br><span class="line">	Shards <span class="keyword">int</span></span><br><span class="line">    </span><br><span class="line">	<span class="comment">// Time after which entry can be evicted</span></span><br><span class="line">    <span class="comment">// 第一次删除的时间</span></span><br><span class="line">	LifeWindow time.Duration</span><br><span class="line">    </span><br><span class="line">	<span class="comment">// Interval between removing expired entries (clean up).</span></span><br><span class="line">	<span class="comment">// If set to &lt;= 0 then no action is performed. Setting to &lt; 1 second is counterproductive — bigcache has a one second resolution.</span></span><br><span class="line">    <span class="comment">// 删除的时间间隔</span></span><br><span class="line">	CleanWindow time.Duration</span><br><span class="line">    </span><br><span class="line">	<span class="comment">// Max number of entries in life window. Used only to calculate initial size for cache shards.</span></span><br><span class="line">	<span class="comment">// When proper value is set then additional memory allocation does not occur.</span></span><br><span class="line">	<span class="comment">// 大概就是删除队列的初始大小，在一开始分配，超过了就动态扩容</span></span><br><span class="line">    MaxEntriesInWindow <span class="keyword">int</span></span><br><span class="line">    </span><br><span class="line">	<span class="comment">// Max size of entry in bytes. Used only to calculate initial size for cache shards.</span></span><br><span class="line">    <span class="comment">// 单个value的最大大小，用于计算初始cache shards大小</span></span><br><span class="line">	MaxEntrySize <span class="keyword">int</span></span><br><span class="line">    </span><br><span class="line">	<span class="comment">// Verbose mode prints information about new memory allocation</span></span><br><span class="line">    <span class="comment">// 机器翻译：详细模式打印有关新内存分配的信息</span></span><br><span class="line">	Verbose <span class="keyword">bool</span></span><br><span class="line">    </span><br><span class="line">	<span class="comment">// Hasher used to map between string keys and unsigned 64bit integers, by default fnv64 hashing is used.</span></span><br><span class="line">    <span class="comment">// 你要使用的哈希函数</span></span><br><span class="line">	Hasher Hasher</span><br><span class="line">    </span><br><span class="line">	<span class="comment">// HardMaxCacheSize is a limit for cache size in MB. Cache will not allocate more memory than this limit.</span></span><br><span class="line">	<span class="comment">// It can protect application from consuming all available memory on machine, therefore from running OOM Killer.</span></span><br><span class="line">	<span class="comment">// Default value is 0 which means unlimited size. When the limit is higher than 0 and reached then</span></span><br><span class="line">	<span class="comment">// the oldest entries are overridden for the new ones.</span></span><br><span class="line">    <span class="comment">// 最大占用内存，不够用时会覆盖就内存，和redis有点像</span></span><br><span class="line">	HardMaxCacheSize <span class="keyword">int</span></span><br><span class="line">    </span><br><span class="line">	<span class="comment">// OnRemove is a callback fired when the oldest entry is removed because of its expiration time or no space left</span></span><br><span class="line">	<span class="comment">// for the new entry, or because delete was called.</span></span><br><span class="line">	<span class="comment">// Default value is nil which means no callback and it prevents from unwrapping the oldest entry.</span></span><br><span class="line">    <span class="comment">// 由于各种原因删除数据时会触发的回调函数</span></span><br><span class="line">	OnRemove <span class="function"><span class="keyword">func</span><span class="params">(key <span class="keyword">string</span>, entry []<span class="keyword">byte</span>)</span></span></span><br><span class="line">    </span><br><span class="line">	<span class="comment">// OnRemoveWithReason is a callback fired when the oldest entry is removed because of its expiration time or no space left</span></span><br><span class="line">	<span class="comment">// for the new entry, or because delete was called. A constant representing the reason will be passed through.</span></span><br><span class="line">	<span class="comment">// Default value is nil which means no callback and it prevents from unwrapping the oldest entry.</span></span><br><span class="line">	<span class="comment">// Ignored if OnRemove is specified.</span></span><br><span class="line">    <span class="comment">// 用于传递释放数据的原因，有Expired，NoSpace，Deleted三种</span></span><br><span class="line">	OnRemoveWithReason <span class="function"><span class="keyword">func</span><span class="params">(key <span class="keyword">string</span>, entry []<span class="keyword">byte</span>, reason RemoveReason)</span></span></span><br><span class="line"></span><br><span class="line">	onRemoveFilter <span class="keyword">int</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// Logger is a logging interface and used in combination with `Verbose`</span></span><br><span class="line">	<span class="comment">// Defaults to `DefaultLogger()`</span></span><br><span class="line">    <span class="comment">// 日志</span></span><br><span class="line">	Logger Logger</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="优化的一些原理"><a href="#优化的一些原理" class="headerlink" title="优化的一些原理"></a>优化的一些原理</h2><h3 id="1、并发优化"><a href="#1、并发优化" class="headerlink" title="1、并发优化"></a>1、并发优化</h3><p>由于bigcache支持并发，因此势必会用锁（事实用的是读写锁）。在高并发场景下，如果只用一把读写锁，势必会显著影响读写速度。解决方案是用分块的思想（想必大家在数据结构上都听老师口糊过），把整个内存分成N个部分，每个部分单独分配一把锁保证并发安全。在哈希函数足够优秀的情况下，就可以实现同时允许好几个协程进行读写。</p>
<p>所以这部分的优化主要是N的选择以及哈希函数的选择。</p>
<h4 id="（1）N的选择"><a href="#（1）N的选择" class="headerlink" title="（1）N的选择"></a>（1）N的选择</h4><p> 首先N肯定不是越大越好，因为太大会带来很多不必要的开销（增加内存使用和寻找所在分块的时间），且性能提升也未必会很明显，所以要在性能和花销上寻找一个平衡。框架作者推荐的值是1024。</p>
<p>另外，N的值最好是2的幂，因为这样底层可以直接用位运算取模，进一步减少时间开销。</p>
<h4 id="（2）Hash算法的选择"><a href="#（2）Hash算法的选择" class="headerlink" title="（2）Hash算法的选择"></a>（2）Hash算法的选择</h4><p><del>太玄学了还是算了</del></p>
<p>看了半天还是用他内置的FNV64a算法吧。</p>
<h3 id="2、GC优化"><a href="#2、GC优化" class="headerlink" title="2、GC优化"></a>2、GC优化</h3><p>Go1.5对GC进行了优化，如果map中的键值对都是基本类型，则GC会忽略他们。</p>
<p>因此框架作者利用这一特性，在每个分块中用map[uint64]uint32和一个预先分配的大字节数组（数组还是切片暂时没有证实）存储数据，把缓存对象序列化的后放到预先分配好的大字节数组中，把它的哈希值作为map[uint64]uint32的key，然后把它在数组中的offset作为map[uint64]uint32的value。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/10/22/fibnaci/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Sarail">
      <meta itemprop="description" content="Fast Fishing Transform">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sarail wanna sleep all day">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/10/22/fibnaci/" class="post-title-link" itemprop="url">Fibnaci</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-10-22 11:21:25 / 修改时间：11:22:50" itemprop="dateCreated datePublished" datetime="2020-10-22T11:21:25+08:00">2020-10-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>谈谈如何设计算法快速求出斐波那契第$n(n &lt; 10^{18})$项？由于结果很大，因此输出对99999989取模的结果。</p>
<p>提示：1、99999989是质数；2、浮点数在经历多次运算后可能会出现精度不够的情况而导致答案错误；3、<math.h>中的pow函数很慢，因此您可能需要重新设计pow函数。</p>
<p>参考公式：斐波那契的通项公式为：</p>
<p>$\frac 1 {\sqrt{5}}[(\frac {1+\sqrt{5}} 2)^n-(\frac {1-\sqrt{5}} 2)^n]$</p>
<p>参考答案：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> MOD = <span class="number">99999989</span>; <span class="comment">//模数，这里保证是一个奇质数</span></span><br><span class="line"><span class="keyword">int</span> inv5 = <span class="number">50122571</span>; <span class="comment">// 根号5的对MOD取模的结果，暴搜得到</span></span><br><span class="line"><span class="comment">//这是负根号5：49877418</span></span><br><span class="line"><span class="comment">//也可以用二次剩余定理求，但这里没必要</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 朴素快速幂，时间上已经足够所以没有用欧拉函数优化</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> base, ll p, <span class="keyword">int</span> mod)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (p &lt;= <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> res = qpow(base, p &gt;&gt; <span class="number">1</span>, mod);</span><br><span class="line">    res = res * <span class="number">1l</span>l * res % mod;</span><br><span class="line">    <span class="keyword">if</span> (p &amp; <span class="number">1</span>)  res = res * <span class="number">1l</span>l * base % mod;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 逆元，费马小定理</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">inv</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> mod)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> qpow(x, mod - <span class="number">2</span>, mod);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 模意义下取绝对值</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">abs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> mod)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (x % mod + mod) % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//用通项公式求斐波那契第n项，时间 O(log MOD)</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fib</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> mod)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a = <span class="built_in">abs</span>(<span class="number">1</span> + inv5, mod) * <span class="number">1l</span>l * inv(<span class="number">2</span>, mod) % mod;</span><br><span class="line">    <span class="keyword">int</span> b = <span class="built_in">abs</span>(<span class="number">1</span> - inv5, mod) * <span class="number">1l</span>l * inv(<span class="number">2</span>, mod) % mod;</span><br><span class="line">    <span class="keyword">return</span> inv(inv5, mod) * <span class="number">1l</span>l * <span class="built_in">abs</span>(qpow(a, n, mod) - qpow(b, n, mod), mod) % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, mod = MOD;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, fib(n, mod));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/10/15/Zeldain-Garden/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Sarail">
      <meta itemprop="description" content="Fast Fishing Transform">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sarail wanna sleep all day">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/10/15/Zeldain-Garden/" class="post-title-link" itemprop="url">Zeldain Garden</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-10-15 00:15:35 / 修改时间：00:36:40" itemprop="dateCreated datePublished" datetime="2020-10-15T00:15:35+08:00">2020-10-15</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>链接：<a target="_blank" rel="noopener" href="https://ac.nowcoder.com/acm/contest/7817/E">https://ac.nowcoder.com/acm/contest/7817/E</a></p>
<h2 id="题目大意"><a href="#题目大意" class="headerlink" title="题目大意"></a>题目大意</h2><p>给定一个区间$[n,m]$,统计这个区间内所有数的因数个数之和（包括1和自身），$1\leqslant n \leqslant m\leqslant 10^{12}$</p>
<h2 id="题目分析"><a href="#题目分析" class="headerlink" title="题目分析"></a>题目分析</h2><p>考虑一个数m的情况：由于所有因数总是成对出现，我们只需要枚举$[1,\sqrt{m}]$即可找出m的所有因数。</p>
<p>引申到区间，首先我们发现，<strong>$[n,m]$中所有数的因数对中，较小的那一个一定会小于$\sqrt{m}$,</strong>写成命题的话就是：</p>
<blockquote>
<p>如果$a*b=x且x\in[n,m]，那么min\{a,b\}\leqslant\sqrt{m} $</p>
</blockquote>
<p>根据这个性质，我们从1到$\sqrt{m}$枚举其中一个因子 $x$,找到这样两个整数$l$，$r$使得：</p>
<script type="math/tex; mode=display">x\leqslant l\leqslant r ,且 n\leqslant l*x \leqslant r*x\leqslant m</script><p>为什么$l,r$要比x大呢？这是为了防止重复计算。如果我们有这样一个数$y$使得</p>
<script type="math/tex; mode=display">n \leqslant y * y \leqslant m且y * (y-1) \geq n</script><p>那么在缺少这个限制时$y$和$y-1$这一对因数就会在$x=y,x=y-1$时分别被计算一次，答案就比正确答案大2。($ y-2,y-3…$同理)</p>
<p>这样，$[n,m]$中所有以x为因子的数的个数就是$r-l+1$，由于因数成对出现，我们就找到了$2*(r-l+1)$个因数。</p>
<p>值得注意的是平方数会多算一个因数，最后要把多余的数减掉。</p>
<h2 id="AC代码："><a href="#AC代码：" class="headerlink" title="AC代码："></a>AC代码：</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span> + <span class="number">50</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line">ll n, m, ans;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">calc</span><span class="params">(ll k)</span> </span>&#123;</span><br><span class="line">    ll l = n / k + (n % k ? <span class="number">1</span> : <span class="number">0</span>), r = m / k;</span><br><span class="line">    l = max(l, k); <span class="comment">//防止重复统计</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">2</span> * (r - l + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">1</span>; i * i &lt;= m; ++i) &#123;</span><br><span class="line">        ans +=  calc(i);</span><br><span class="line">        <span class="keyword">if</span> (i * i &gt;= n) ans--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/10/15/Flowers/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Sarail">
      <meta itemprop="description" content="Fast Fishing Transform">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sarail wanna sleep all day">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/10/15/Flowers/" class="post-title-link" itemprop="url">Flowers</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-10-15 00:14:51 / 修改时间：00:43:26" itemprop="dateCreated datePublished" datetime="2020-10-15T00:14:51+08:00">2020-10-15</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>题目链接：<a target="_blank" rel="noopener" href="https://ac.nowcoder.com/acm/contest/7830/J">https://ac.nowcoder.com/acm/contest/7830/J</a></p>
<h3 id="题目大意："><a href="#题目大意：" class="headerlink" title="题目大意："></a>题目大意：</h3><p>有n种花，第$i $种花有$a_i$朵。现在要用m朵花组成一束花，要求每束花的中每朵花的种类各不相同，求最多组成几束花。</p>
<h3 id="题目分析："><a href="#题目分析：" class="headerlink" title="题目分析："></a>题目分析：</h3><p>假设m=2，这就变成了一个配对问题。我们设$m=max\{a_i\},tot=sum\{a_i\}$,当$m\leq\frac {tot}{2}$,则一定是能够恰好两两配对的（花朵总数为奇数会有一个剩余），答案为$\frac{tot}{2}$。反之，数量最多的那种花一定能和其他所有花配对，此时我们只要考虑剩下的花就可以了，答案为$tot -m$。</p>
<p>那么对于m大于2的情况怎么办呢？很简单，只要某一束花大于等于$\frac{tot}{m}$，这种花就一定能和其他所有花配对，我们把这种花的数量从tot里删掉，再把m减1就可以了，最后的答案是$\frac{tot}m$,注意这里的tot是删完之后剩下的花的总数。</p>
<h3 id="AC代码"><a href="#AC代码" class="headerlink" title="AC代码"></a>AC代码</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> a[N], n, m;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T; <span class="built_in">cin</span> &gt;&gt; T;</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">        ll tot = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a + i);</span><br><span class="line">            tot += a[i];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="keyword">if</span> (a[i] &gt;= tot / m) &#123;</span><br><span class="line">            tot -= a[i];</span><br><span class="line">            m--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; tot / m &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/10/15/Identical%20Trees/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Sarail">
      <meta itemprop="description" content="Fast Fishing Transform">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sarail wanna sleep all day">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/10/15/Identical%20Trees/" class="post-title-link" itemprop="url">Identical Trees</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-10-15 00:12:55 / 修改时间：00:14:13" itemprop="dateCreated datePublished" datetime="2020-10-15T00:12:55+08:00">2020-10-15</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>链接：<a target="_blank" rel="noopener" href="https://ac.nowcoder.com/acm/contest/5675/J">https://ac.nowcoder.com/acm/contest/5675/J</a></p>
<h3 id="题目大意："><a href="#题目大意：" class="headerlink" title="题目大意："></a>题目大意：</h3><p>给两颗有根树，每个节点有一个标签，每次操作可以任意修改一个标签，问使这两棵树完全相同需要的最少的操作次数。</p>
<h3 id="题目分析："><a href="#题目分析：" class="headerlink" title="题目分析："></a>题目分析：</h3><p>容易发现这个问题等价于找个对应关系，使得相同的标号尽量多，剩下的标号需要修改。可以用树形dp，转移的时候使用二分图最大权匹配。</p>
<p>具体来说，先对每一个子树进行树哈希（用于判断是否同构），然后进行树形dp。dp时，若发现树1的子树a和树2中的子树b同构，则考虑将他们匹配并求出他们匹配时最多有多少对节点的标签会相同。最大的标签数如何求呢？就是前述的二分图最大权匹配：枚举子树a和子树b的儿子节点，若发现以这两个节点为根的树同构（哈希值相同），则连一条边，边权为递归调用dp方法计算出的这两棵子树配对的最多相同标签的节点数；枚举完所有情况后，再做一遍km算法求出最大权匹配，若子树a与子树b的标签相同，答案为最大权+1，否则为最大权。显然，叶子节点就是天然的递归边界。</p>
<p>另外，虽然题目的数据规模为500，但是在树形结构下二分图中实际有边相连的点的个数会很少，就算是$O(n^4)$的km算法也会跑的非常快（就算是菊花图）。树哈希的方法也有很多种，且一般不容易被卡，<del>随便瞎搞应该也都是可以的</del>。</p>
<h3 id="AC代码"><a href="#AC代码" class="headerlink" title="AC代码"></a>AC代码</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">500</span> + <span class="number">50</span>,base = <span class="number">23333</span>,inf = <span class="number">1e17</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> t1[N],t2[N];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> u,sz;</span><br><span class="line">    ull h; <span class="comment">// 以当前节点为根的子树的哈希值，用于判断是否同构。自然溢出取模</span></span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; son;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> == (<span class="keyword">const</span> node&amp; rhs) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (h == rhs.h) &amp;&amp; (sz == rhs.sz);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;t[N &lt;&lt; <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span> &#123;</span></span><br><span class="line">	<span class="keyword">int</span> from,to,dist;</span><br><span class="line">	edge(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> d) : from(u),to(v),dist(d) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">ll Left[N],Lx[N],Ly[N],w[N][N];</span><br><span class="line"><span class="keyword">bool</span> S[N],T[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">match</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">	S[i] = <span class="literal">true</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; ++j) <span class="keyword">if</span> (Lx[i] + Ly[j] == w[i][j] &amp;&amp; !T[j]) &#123;</span><br><span class="line">		T[j] = <span class="literal">true</span>;</span><br><span class="line">		<span class="keyword">if</span> (!Left[j] || match(Left[j],n)) &#123;</span><br><span class="line">			Left[j] = i;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; </span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">	ll a = <span class="number">1e18</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="keyword">if</span>(S[i])</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; ++j) <span class="keyword">if</span>(!T[j])</span><br><span class="line">			a = min(a, Lx[i] + Ly[j] - w[i][j]);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">		<span class="keyword">if</span> (S[i]) Lx[i] -= a;</span><br><span class="line">		<span class="keyword">if</span> (T[i]) Ly[i] += a;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">km</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">		Left[i] = <span class="number">0</span>;</span><br><span class="line">		Lx[i] = Ly[i] = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; ++j) </span><br><span class="line">			Lx[i] = max(Lx[i], w[i][j]);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">		<span class="keyword">for</span>( ; ;) &#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; ++j) S[j] = T[j] = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">if</span> (match(i, n)) <span class="keyword">break</span>; <span class="keyword">else</span> update(n);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回的结果为最优匹配中编号相同节点的个数最大值</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">buildMap</span><span class="params">(<span class="keyword">int</span> rt1, <span class="keyword">int</span> rt2)</span> </span>&#123;</span><br><span class="line">	<span class="built_in">vector</span>&lt;edge&gt; stk;</span><br><span class="line">	<span class="keyword">int</span> t1, t2, nn = <span class="number">0</span>, res = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// 由于建树方式能保证一棵树的儿子节点在t数组中的下标总是连续的</span></span><br><span class="line">    <span class="comment">// 因此在这里我们将每一个儿子节点的与第0个儿子的下标的差值加一</span></span><br><span class="line">    <span class="comment">// 作为其在二分图中的编号，以此来减少km算法的时间开销</span></span><br><span class="line">	<span class="keyword">if</span> (t[rt1].son.size() &gt; <span class="number">0</span>) </span><br><span class="line">		t1 = t[rt1].son[<span class="number">0</span>], t2 = t[rt2].son[<span class="number">0</span>], nn = t[rt1].son.size();</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> son1 : t[rt1].son)</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> son2 : t[rt2].son) </span><br><span class="line">			<span class="keyword">if</span>(t[son1] == t[son2]) </span><br><span class="line">				stk.push_back(edge(son1 - t1 + <span class="number">1</span>, son2 - t2 + <span class="number">1</span>, buildMap(son1,son2)));</span><br><span class="line">		</span><br><span class="line">    <span class="comment">// 待儿子节点计算完后，才开始计算当前节点否则图中会有多余的边</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> e : stk) w[e.from][e.to] = e.dist;</span><br><span class="line">	km(nn);	</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= nn; ++i) res += w[Left[i]][i];</span><br><span class="line">    <span class="comment">// 还原</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> e : stk) w[e.from][e.to] = -inf;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">// 这里注意要判断当前节点是否相同</span></span><br><span class="line">	<span class="keyword">return</span> res + (t[rt1].u == t[rt2].u ? <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> isprime[N * N];</span><br><span class="line"><span class="keyword">int</span> prime[N];</span><br><span class="line"><span class="keyword">int</span> n,tot,ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_prime</span><span class="params">(<span class="keyword">int</span> MAX)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(isprime, <span class="literal">true</span>, <span class="keyword">sizeof</span>(isprime));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; MAX; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (x &gt; N - <span class="number">10</span>) <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">if</span> (isprime[i]) prime[x++] = i;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; x; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i * prime[j] &gt;= MAX) <span class="keyword">break</span>;</span><br><span class="line">            isprime[i * prime[j]] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % prime[j] == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">    t[u].sz = <span class="number">1</span>; t[u].h = <span class="number">0</span>;</span><br><span class="line">    sort(t[u].son.begin(),t[u].son.end());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> v : t[u].son) &#123;</span><br><span class="line">        dfs(v);</span><br><span class="line">        t[u].sz += t[v].sz;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> v : t[u].son) t[u].h += t[v].h * prime[t[v].sz];</span><br><span class="line">    t[u].h++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span>* p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> rt = ++tot;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n ; ++i)</span><br><span class="line">        <span class="keyword">if</span> (p[i] == <span class="number">0</span>)&#123;</span><br><span class="line">            t[rt].u = i;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; Q;</span><br><span class="line">    Q.push(rt);</span><br><span class="line">    <span class="keyword">while</span> (!Q.empty()) &#123;</span><br><span class="line">        <span class="keyword">int</span> u = Q.front(); Q.pop();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            <span class="keyword">if</span> (p[i] == t[u].u) &#123;</span><br><span class="line">                t[u].son.push_back(++tot);</span><br><span class="line">                t[tot].u = i;</span><br><span class="line">                Q.push(tot);</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(rt);</span><br><span class="line">    <span class="keyword">return</span> rt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">cin</span>.tie(<span class="number">0</span>); <span class="built_in">cout</span>.tie(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">	get_prime(N * N - <span class="number">100</span>);</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; ++i) </span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= n; ++j)</span><br><span class="line">			w[i][j] = -inf;</span><br><span class="line">			</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">cin</span> &gt;&gt; t1[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">cin</span> &gt;&gt; t2[i];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> rt1 = build(t1), rt2 = build(t2);</span><br><span class="line"></span><br><span class="line">    ans = <span class="number">0</span>;</span><br><span class="line">    ans = max(ans,n - buildMap(rt1,rt2));</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Sarail"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">Sarail</p>
  <div class="site-description" itemprop="description">Fast Fishing Transform</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">9</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/sarailQAQ" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;sarailQAQ" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/847117505@qq.com" title="E-Mail → 847117505@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Sarail</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  
  <script color='0,0,255' opacity='0.5' zIndex='-1' count='99' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
